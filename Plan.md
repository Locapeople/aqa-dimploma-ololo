# Планирование автоматизации тестирования

## Перечень автоматизируемых сценариев

### Описание формата значений полей формы

Корректными значениями, которые принимаются в поля для ввода платежных данных, являются:

- Номер карты
  - 16 цифр
  - предустановленный набор известных SUT номеров - в файле [`data.json`](gate-simulator/data.json) (далее - "карта 1" и "карта 2")
- Год
  - две цифры года (отсчет принимается ведущимся с 2000 года)
  - не ранее текущего года
- Месяц
  - цифры от 01 до 12
  - если год указан текущий - число не менее номера текущего месяца
  - в остальных случаях - набор произвольный
- Владелец
  - буквы латинского алфавита
- CVC/CVV
  - 3 цифры

### Список сценариев

- Стандартные позитивные сценарии
  - Покупка билетов: корректные данные по карте 1 с ожиданием сообщения об успехе от сервера
    - №: 1
    - id: `Card1BuyWithDefaultInputs`
    - Данные формы
      - номер карты 1: 4444 4444 4444 4441
      - остальные поля - произвольные корректные значения
    - Ожидаемый результат
      - WEB: появление окна "Операция одобрена Банком"
      - DB: появление записи со свойством `payment_entity: APPROVED`
  - Покупка билетов в кредит: корректные данные по карте 1 с ожиданием сообщения об успехе от сервера
    - №: 2
    - id: `Card1CreditWithDefaultInputs`
    - Данные формы
      - аналогично предыдущему сценарию
    - Ожидаемый результат
      - WEB: появление окна "Операция одобрена Банком"
      - DB: появление записи со свойством `credit_request_entity: APPROVED`
  - Покупка билетов: корректные данные по карте 2 с ожиданием сообщения об отказе
    - №: 3
    - id: `Card2BuyWithDefaultInputs`
    - Данные формы
      - номер карты 1: 4444 4444 4444 4442
      - остальные поля - произвольные корректные значения
    - Ожидаемый результат
      - WEB: появление окна "Ошибка! Банк отказал в проведении операции"
      - DB: появление записи со свойством `payment_entity: DECLINED`
  - Покупка билетов в кредит: корректные данные по карте 2 с ожиданием сообщения об отказе
    - №: 4
    - id: `Card2CreditWithDefaultInputs`
    - Данные формы
      - аналогично предыдущему сценарию
    - Ожидаемый результат
      - WEB: появление окна "Ошибка! Банк отказал в проведении операции"
      - DB: появление записи со свойством `credit_request_entity: DECLINED`
- Стандартные негативные сценарии
  - Ввод некорректных данных (любой метод оплаты)
    - Отсутствие ввода в любом из необходимых полей данных карты 
      - Данные формы
        - отсутствие данных в полях:
          - номер карты
            - №: 5
            - id: `NoCardInout`
          - год
            - №: 6
            - id: `NoDueYearInout`
          - месяц
            - №: 7
            - id: `NoDueMonthInout`
          - владелец
            - №: 8
            - id: `NoHolderInout`
          - CVC/CVV
            - №: 9
            - id: `NoCVVInout`
        - остальные поля - произвольные корректные значения
      - Ожидаемый результат
        - WEB: появление сообщения "Неверный формат" под соответствующим полем
        - DB: отсутствие новой записи
  - Ввод неизвестного для SUT номера карты с ожиданием сообщения об ошибке
    - №: 10
    - id: `UnknownCardInout`
    - Данные формы
      - номер карты 1: 5555 5555 5555 5555
      - остальные поля - произвольные корректные значения
    - Ожидаемый результат
      - WEB: появление окна "Ошибка! Банк отказал в проведении операции"
      - DB: отсутствие новой записи
  - Ввод некорректного срока действия (истекший срок)
    - Истекший срок по месяцу
      - №: 11
      - id: `PastDueMonthInout`
      - Данные формы
        - номер карты 1: 4444 4444 4444 4441
        - месяц: предыдущий (на момент написания документа - номер `01`)
        - год: текущий (на момент написания документа - номер `24`)
        - остальные поля - произвольные корректные значения
      - Ожидаемый результат
        - WEB: появление сообщения "Истёк срок действия карты" под полем "Месяц"
        - DB: отсутствие новой записи
    - Истекший срок по году
      - №: 12
      - id: `PastDueYearInout`
      - Данные формы
        - номер карты 1: 4444 4444 4444 4441
        - месяц: текущий (на момент написания документа - номер `02`)
        - год: предыдущий (на момент написания документа - номер `23`)
        - остальные поля - произвольные корректные значения
      - Ожидаемый результат
        - WEB: появление сообщения "Истёк срок действия карты" под полем "Год"
        - DB: отсутствие новой записи
  - Ввод некорретного имени владельца карты
    - №: 13
    - id: `WrongHolderInout`
    - Данные формы
      - номер карты 1: 4444 4444 4444 4441
      - владелец: кириллический набор случайных символов
      - остальные поля - произвольные корректные значения
    - Ожидаемый результат
      - WEB: появление сообщения "Неверный формат" под полем "Владелец"
      - DB: отсутствие новой записи
  - Ввод некорректного CVC/CVV
    - №: 14
    - id: `WrongCVVInout`
    - Данные формы
      - номер карты 1: 4444 4444 4444 4441
      - CVC/CVV: `0`
      - остальные поля - произвольные корректные значения
    - Ожидаемый результат
      - WEB: появление сообщения "Неверный формат" под полем CVC/CVV
      - DB: отсутствие новой записи
- Нестандартные позитивные сценарии
  - Ввод данных карты (граничные условия) с ожиданием сообщения об успехе от сервера
    - Ввод корректного срока действия (текущий месяц текущего года)
      - №: 15
      - id: `ThresholdDueDateInout`
      - Данные формы
        - номер карты 1: 4444 4444 4444 4441
        - месяц: текущий (на момент написания документа - номер `02`)
        - год: текущий (на момент написания документа - номер `24`)
        - остальные поля - произвольные корректные значения
      - Ожидаемый результат
        - WEB: появление окна "Операция одобрена Банком"
        - DB: появление записи со свойством `payment_entity: APPROVED`
    - Ввод корректного, но далекого срока действия
      - №: 16
      - id: `FarFutureDueYearInout`
      - Данные формы
        - номер карты 1: 4444 4444 4444 4441
        - год: текущий+10 (на момент написания документа - номер `34`)
        - остальные поля - произвольные корректные значения
      - Ожидаемый результат
        - WEB: появление окна "Операция одобрена Банком"
        - DB: появление записи со свойством `payment_entity: APPROVED`

## Перечень используемых инструментов с обоснованием выбора

Тестовый стек:
- **JUnit** - хорошо подходит для тестирования web-приложений 
- **Selenide** - удобный инструмент автоматизации интерфейса пользователя за счет использования гибких CSS-селекторов
- **Lombok** - еще один удобный инструмент, упрощающий доступ усправление объектами

## Перечень и описание возможных рисков при автоматизации

Основные риски - баги на стороне приложения/симулятора, которые будут давать неожиданные результаты, требующие проверки на корректность.

## Интервальная оценка с учётом рисков в часах

Примерная оценка:
- 0.5 часов на написание каждого автотеста
- до 1 часа на отладку каждого автотеста
- до 2 часов на формирование отчета по тестированию + оформление issue на неожиданные сценарции/баги SUT
Итого: 11 автотестов * (0.5 + 1) + 2 = ~19 часов (~2.5-3 рабочих дня) на подготовку результатов тестирования.

## План сдачи работ: когда будут готовы автотесты, результаты их прогона

- автотесты ожидаются 02/09/24
- отчет и анализ результатов ожидается 03/09/24
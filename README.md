# Дипломный проект по профессии «Тестировщик»

Дипломный проект — автоматизация тестирования комплексного сервиса, взаимодействующего с СУБД и API Банка.

## Отчетные документы

Все отчеты расположены в каталоге `doc/`:

- [`Plan.md`](doc/Plan.md) - план выполнения работы
- [`Report.md`](doc/Report.md) - отчет по итогам тестирования
- [`Summary.md`](doc/Summary.md) - отчет по итогам автоматизации

## Начало работы

Для работы над проектом требуется выполнить подготовительные действия, описанные ниже.

1. Клонировать проект, используя `git clone https://github.com/Locapeople/aqa-dimploma-ololo.git`
2. Установить зависимости:
   - [Java](https://www.java.com/en/download/)
   - [Node.js](https://nodejs.org/en/download/)
   - [Docker](https://www.docker.com/products/docker-desktop/) и утилита `docker compose` (устанавливается отдельно)

## Запуск проекта

### Запуск SUT

SUT состоит из набора сервисов:
- БД на базе MySQL
- БД на базе PostgreSQL
- симулятора транзакций `gate-simulator`

а также непосредственно тестируемого приложения.

Для запуска SUT необходимо выполнить shell-скрипт `./start.sh DBTYPE`, где аргумент `DBTYPE` равен:
- для варианта запуска под MySQL: `mysql`
- для варианта запуска под PostgreSQL: `postgres`

При этом будут запущены контейнеры сервисов, запущено приложение (доступ по адресу `localhost` на порту `8080`, 
а также создан файл `app.pid`, необходимый для отслеживания процесса приложения.
Логи сервисов и приложения будут вестись в файлы `services.log` и `app.log` соответственно.

**❗️ВАЖНО:** БД на базе PostgreSQL создается по умолчанию с конфигурацией, где метод аутентификации по умолчанию - `trust`, 
в связи с чем тестовая система не в состоянии подключиться к ней во время тестов, используя пароль.
Для решения этой проблемы требуется выполнить действия:
- Выполнить `./start.sh postgres`
- Открыть файл `./env/psql-data/pg_hba.conf` и в строке:
  ```bash
  host all all all scram-sha-256
  ```
  заменить `scram-sha-256` на `password` и закрыть файл с сохранением.
- Перезапустить сервисы, выполнив `./stop.sh && ./start.sh postgres`

### Остановка SUT

Для остановки SUT необходимо выполнить shell-скрипт `./stop.sh`.

Будут остановлены контейнеры сервисов и тестируемое приложение, файл `app.pid` будет удален автоматически.

## Запуск тестов

Для запуска тестов выполнить shell-скрипт `./test.sh DBTYPE`, 
где аргумент `DBTYPE` равен одному из значений, описанных выше в разделе "Запуск SUT" 
и совпадает с тем, что было указано для запуска SUT.

Отчет о тестировании будет подготовлен по пути `build/reports/tests/test`.
